# RELEX - Test Automation Framework  

**REL**iable **EX**ecution (**RELEX**) is a powerful test automation framework designed for **Command Line Interface (CLI) testing**. It emphasizes **ease of automation**, **stable regression**, and **seamless debugging**.  

---

## 🚀 Why Choose RELEX?  

### 🔄 Dynamic Device Selection  
Imagine running 10 scripts in regression, but the device goes down after script #5 due to a bug. Normally, the remaining 5 tests would fail simply because the device is unreachable.  
With **RELEX**, another device matching the criteria from the parameter file is automatically selected. This ensures you still get results for **9 out of 10 tests**, minimizing wasted runs.  

### 🧹 Efficient Cleanup  
Integration often fails due to improper cleanup from previous test runs.  
**RELEX** introduces a **STEP + CLEAN** approach, ensuring every configuration step has a corresponding cleanup step. This eliminates residue issues and stabilizes your regression pipeline.  

### 🐞 Pause & Debug Anytime  
Need to debug in the middle of a run?  
With **RELEX**, you can drop into **interpreter mode** at any point in your script. You can even validate entire new scripts interactively before adding them to regression. This drastically reduces debugging time.  

### 📊 Multi-Test Approach  
Matrix-style test cases often share common steps but differ in a few variations.  
**RELEX** supports a **setup function** where shared steps run once, while test-specific steps are isolated in their respective test cases. This reduces duplication and improves maintainability.  

### 🧩 Function-Based Script Design  
Scripts in **RELEX** are created as **sets of reusable functions**.  
If two different Devices Under Test (DUTs) share similar functionality, the same script can be reused by simply creating DUT-specific function definitions.  
This approach makes it:  
- Easy to **organize** automation scripts  
- Simple to **reuse and extend** across multiple DUTs  
- Maintainable in the long run, reducing code duplication

### 📜 Transparent Logging  
Stay in control with **real-time console logs** and **detailed log files**. At the end of execution, a clear **summary report** highlights key results, saving you from manual log digging.  

---

## ✨ Key Benefits  

- Stable and resilient regression runs  
- Cleaner automation with enforced cleanup  
- Interactive debugging on the fly  
- Optimized multi-test execution
- Function-based scripting for reuse and maintainability
- Clear and transparent reporting  

---

## 📖 Getting Started  

### 🚀 Setup Instructions

Follow these steps to set up the project on your machine:

### 1. Clone the Repository
```bash
git clone git@github.com:ashokngit/relex.git
```
### 2. Navigate into the Project Directory
```bash
cd relex
```
### 3. Configure Environment Variable
Add the project’s lib/infra folder to your PYTHONPATH so Python can locate the modules:
```bash
echo "export PYTHONPATH=$PWD/lib/infra" >> ~/.bash_profile
```
### 4. Reload Your Shell Configuration
To apply the changes immediately without reboot:
```bash
source ~/.bash_profile
```

✅ After completing these steps, your environment will be ready to run the script.


### Directory structure
```text
relex
├── lib
│   ├── func
│   │   └── linux
│   │       └── checkFile.py
│   ├── infra
│   │   ├── relex.py
│   │   ├── testArgs.py
│   │   └── testLogger.py
│   ├── utility
│   └── workflow
├── logs
│   └── sampleScript1_2025-09-06T10:32:57.690817.log
├── README.md
├── script
│   └── sample
│       ├── sampleScript1.prm
│       └── sampleScript1.py
└── testbed
    └── sampletb.yaml
```
_lib_ - Core library containing reusable modules and functions.

_lib/infra_ - Framework infrastructure modules (e.g., logging, argument parsing, core execution logic).

_lib/func_ - Device-specific functions

_lib/utility_ - General-purpose helper functions (independent of devices)

_lib/workflow_ - Workflow orchestration functions that chain multiple modules together.

_script_ - Directory for test scripts along with its parameter files

_testbed_ - YAML-based testbed configuration files

_logs_ - Execution logs generated by the framework

## Writing Your First Script with Relex

As programmers, we usually start with a classic **"Hello, World!"** example.  
This section shows you how to write your very first script in `relex`.  

We will use **print messages** in all `STEP` and `CLEAN` sections to help you get familiar with the **execution flow**.  

---

### Script Structure

Every script follows this general pattern:

1. **Import the relex module**
2. **Define a `Setup()` function**  
   - Contains preparation logic before running tests. Actions common for all Tests 
   - Each action is split into **STEP** and **CLEAN** sections.  
3. **Define one or more Test functions**  
   - Each test has its own **STEP** and **CLEAN** sections.  
4. **Call `relex.testExec()`**  
   - Passes the `Setup` and all Test functions to the framework.  

---

### Example: Hello World Script
hello.py
```python
import relex

def Setup():
    #STEP - Sample step 1
    OK("Setup step 1")

    #CLEAN - Sample clean 1
    OK("Setup clean 1")

    #STEP - Sample step 2
    OK("Setup step 2")

    #CLEAN - Sample clean 2
    OK("Setup clean 2")

def Test():
    #STEP - Test Step 1
    INFO("This is a variable i defined in param file: " + param["vars"]["msg"])
    OK("Test step 1")

    #CLEAN - Test Clean 1
    OK("Test clean 1")

    #STEP - Test Step 2
    OK("Hello, World", "TestCase")

    #CLEAN - Test Clean 2
    OK("Test clean 2")

relex.testExec(Setup, Test)
```
* ```param["vars"]["msg"]``` - This is how you access a variable from param file inside your script
* ```OK("Hello, World", "TestCase")``` - The `"TestCase"` label indicates the **deciding step** of the test execution.  
                                         This is the step whose outcome determines whether the entire **Test** is marked as **Passed** or **Failed**.

### Example: Hello World Param
 This param file is created in the same directory as script with name same as script but with extension .prm
hello.prm
```yaml
vars:
    msg: "I am a variable used in script"
```
### Running the Script

Run the script using the following(Input arguments will be shown at a later time):

```code
python3 hello.py
```

### Example Execution Output

```code
user@vm:~/git_code/relex/script/sample$ python3 hello.py 
2025-09-14 12:14:25,337 - relex - INFO - Log file: /home/user/git_code/relex/logs/hello_2025-09-14T12:14:25.336452.log
2025-09-14 12:14:25,338 - relex - INFO - Station file: /home/user/git_code/relex/testbed/sampletb.yaml
2025-09-14 12:14:25,338 - relex - INFO - Param file: /home/user/git_code/relex/script/sample/hello.prm
2025-09-14 12:14:25,338 - relex - INFO - Log level: debug
2025-09-14 12:14:25,348 - relex - INFO - *** Starting Execution Of Script - /home/user/git_code/relex/script/sample/hello.py ***
2025-09-14 12:14:25,358 - relex - OK - Setup step 1
2025-09-14 12:14:25,359 - relex - OK - Setup step 2
2025-09-14 12:14:25,361 - relex - INFO - +++ Starting Execution Of Test +++
2025-09-14 12:14:25,361 - relex - INFO - This is a variable i defined in param file: I am a variable used in script
2025-09-14 12:14:25,362 - relex - OK - Test step 1
2025-09-14 12:14:25,363 - relex - OK - Hello, World
2025-09-14 12:14:25,365 - relex - OK - Test clean 2
2025-09-14 12:14:25,366 - relex - OK - Test clean 1
2025-09-14 12:14:25,366 - relex - INFO - +++ Ending Execution Of Test +++
2025-09-14 12:14:25,366 - relex - OK - Setup clean 2
2025-09-14 12:14:25,367 - relex - OK - Setup clean 1
2025-09-14 12:14:25,367 - relex - INFO - *** Ending Script Execution ***


====================================================================================================
                                                     Execution Summary
====================================================================================================
2025-09-14 12:14:25,349 - [INFO] - *** Starting Execution Of Script - /home/user/git_code/relex/script/sample/hello.py ***
2025-09-14 12:14:25,359 - [OK] - Setup step 1
2025-09-14 12:14:25,360 - [OK] - Setup step 2
2025-09-14 12:14:25,361 - [INFO] - +++ Starting Execution Of Test +++
2025-09-14 12:14:25,362 - [INFO] - This is a variable i defined in param file: I am a variable used in script
2025-09-14 12:14:25,363 - [OK] - Test step 1
2025-09-14 12:14:25,364 - [OK] - Hello, World
2025-09-14 12:14:25,366 - [OK] - Test clean 2
2025-09-14 12:14:25,366 - [OK] - Test clean 1
2025-09-14 12:14:25,366 - [INFO] - +++ Ending Execution Of Test +++
2025-09-14 12:14:25,366 - [OK] - Setup clean 2
2025-09-14 12:14:25,367 - [OK] - Setup clean 1
2025-09-14 12:14:25,368 - [INFO] - *** Ending Script Execution ***
====================================================================================================
====================================================================================================
+----------------------------------------------------+
|          Total Number Of Test Passed = 1           |
|          Total Number Of Test Failed = 0           |
|                 Script has Passed!                 |
+----------------------------------------------------+
user@vm:~/git_code/relex/script/sample$ 
```

### Understanding Execution Flow

* Setup STEPs → executed in queue order.

* Setup CLEANs → executed in stack order (Eexcuted at the end of all Tests, last CLEAN executed first).

* Test STEPs → executed in queue order.

* Test CLEANs → executed in stack order after test steps.

### Execution Flow (Top-Down)
```text
 ┌───────────────┐
 │  Setup STEP 1 │
 └───────┬───────┘
         │
 ┌───────────────┐
 │  Setup STEP 2 │
 └───────┬───────┘
         │
 ┌───────────────┐
 │  Test STEP 1  │
 └───────┬───────┘
         │
 ┌───────────────┐
 │  Test STEP 2  │
 └───────┬───────┘
         │
 ┌───────────────┐
 │ Test CLEAN 2  │
 └───────┬───────┘
         │
 ┌───────────────┐
 │ Test CLEAN 1  │
 └───────┬───────┘
         │
 ┌───────────────┐
 │ Setup CLEAN 2 │
 └───────┬───────┘
         │
 ┌───────────────┐
 │ Setup CLEAN 1 │
 └───────────────┘
```


_Coming soon: detailed scripting instructions._  
